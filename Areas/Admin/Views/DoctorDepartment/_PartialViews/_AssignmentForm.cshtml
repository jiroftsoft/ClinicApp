@model ClinicApp.ViewModels.DoctorManagementVM.DoctorDepartmentViewModel

<div class="assignment-form-card p-4">
    @using (Html.BeginForm("Assign", "DoctorDepartment", FormMethod.Post, new { id = "assignmentForm" }))
    {
        @Html.AntiForgeryToken()
        @Html.ValidationSummary(true, "", new { @class = "alert alert-danger" })

        <!-- Doctor Selection Section -->
        <div class="form-section">
            <h5>
                <i class="fas fa-user-md me-2"></i>
                انتخاب پزشک
            </h5>
            <div class="row">
                <div class="col-md-6">
                    <div class="form-group">
                        @Html.LabelFor(m => m.DoctorId, "پزشک", new { @class = "form-label fw-bold" })
                        <select id="DoctorId" name="DoctorId" class="form-control select2" required>
                            <option value="">انتخاب پزشک...</option>
                        </select>
                        @Html.ValidationMessageFor(m => m.DoctorId, "", new { @class = "text-danger" })
                        <div class="help-text">پزشک مورد نظر را انتخاب کنید</div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-group">
                        <label class="form-label fw-bold">اطلاعات پزشک</label>
                        <div id="doctorInfo" class="p-3 bg-light rounded">
                            <p class="text-muted mb-0">پزشک را انتخاب کنید تا اطلاعات نمایش داده شود</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Department Selection Section -->
        <div class="form-section">
            <h5>
                <i class="fas fa-hospital me-2"></i>
                انتخاب دپارتمان
            </h5>
            <div class="row">
                <div class="col-md-6">
                    <div class="form-group">
                        @Html.LabelFor(m => m.DepartmentId, "دپارتمان", new { @class = "form-label fw-bold" })
                        <select id="DepartmentId" name="DepartmentId" class="form-control select2" required>
                            <option value="">انتخاب دپارتمان...</option>
                        </select>
                        @Html.ValidationMessageFor(m => m.DepartmentId, "", new { @class = "text-danger" })
                        <div class="help-text">دپارتمان مورد نظر را انتخاب کنید</div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-group">
                        <label class="form-label fw-bold">اطلاعات دپارتمان</label>
                        <div id="departmentInfo" class="p-3 bg-light rounded">
                            <p class="text-muted mb-0">دپارتمان را انتخاب کنید تا اطلاعات نمایش داده شود</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Assignment Details Section -->
        <div class="form-section">
            <h5>
                <i class="fas fa-cog me-2"></i>
                جزئیات انتساب
            </h5>
            <div class="row">
                <div class="col-md-6">
                    <div class="form-group">
                        @Html.LabelFor(m => m.Role, "نقش در دپارتمان", new { @class = "form-label fw-bold" })
                        <select id="Role" name="Role" class="form-control select2" required>
                            <option value="">انتخاب نقش...</option>
                            <option value="رئیس دپارتمان">رئیس دپارتمان</option>
                            <option value="پزشک معاون">پزشک معاون</option>
                            <option value="پزشک عادی">پزشک عادی</option>
                            <option value="مشاور">مشاور</option>
                            <option value="پزشک متخصص">پزشک متخصص</option>
                        </select>
                        @Html.ValidationMessageFor(m => m.Role, "", new { @class = "text-danger" })
                        <div class="help-text">نقش پزشک در دپارتمان را مشخص کنید</div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-group">
                        @Html.LabelFor(m => m.IsActive, "وضعیت", new { @class = "form-label fw-bold" })
                        <div class="form-check">
                            @Html.CheckBoxFor(m => m.IsActive, new { @class = "form-check-input", @checked = "checked" })
                            <label class="form-check-label" for="@Html.IdFor(m => m.IsActive)">
                                فعال
                            </label>
                        </div>
                        @Html.ValidationMessageFor(m => m.IsActive, "", new { @class = "text-danger" })
                        <div class="help-text">وضعیت فعال بودن انتساب</div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-6">
                    <div class="form-group">
                        @Html.LabelFor(m => m.StartDateShamsi, "تاریخ شروع", new { @class = "form-label fw-bold" })
                        @Html.TextBoxFor(m => m.StartDateShamsi, new { @class = "form-control persian-date", placeholder = "مثال: 1402/01/01", autocomplete = "off" })
                        @Html.ValidationMessageFor(m => m.StartDateShamsi, "", new { @class = "text-danger" })
                        <div class="help-text">تاریخ شروع فعالیت در دپارتمان</div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-group">
                        @Html.LabelFor(m => m.EndDateShamsi, "تاریخ پایان (اختیاری)", new { @class = "form-label fw-bold" })
                        @Html.TextBoxFor(m => m.EndDateShamsi, new { @class = "form-control persian-date", placeholder = "مثال: 1402/12/29", autocomplete = "off" })
                        @Html.ValidationMessageFor(m => m.EndDateShamsi, "", new { @class = "text-danger" })
                        <div class="help-text">تاریخ پایان فعالیت (در صورت موقت بودن)</div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-12">
                    <div class="form-group">
                        @Html.LabelFor(m => m.Notes, "یادداشت‌ها", new { @class = "form-label fw-bold" })
                        @Html.TextAreaFor(m => m.Notes, new { @class = "form-control", rows = "3", placeholder = "یادداشت‌های مربوط به انتساب..." })
                        @Html.ValidationMessageFor(m => m.Notes, "", new { @class = "text-danger" })
                        <div class="help-text">توضیحات اضافی در مورد انتساب</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Validation Summary -->
        <div id="validationSummary" class="alert alert-danger" style="display: none;">
            <h6>خطاهای اعتبارسنجی:</h6>
            <ul id="validationErrors"></ul>
        </div>

        <!-- Action Buttons -->
        <div class="row mt-4">
            <div class="col-12">
                <div class="d-flex justify-content-center">
                    <button type="submit" class="btn btn-success me-3" id="submitBtn">
                        <i class="fas fa-save me-2"></i>
                        ذخیره انتساب
                    </button>
                    <button type="button" class="btn btn-outline-secondary me-3" onclick="resetForm()">
                        <i class="fas fa-undo me-2"></i>
                        پاک کردن فرم
                    </button>
                    <a href="@Url.Action("Index", "DoctorDepartment")" class="btn btn-outline-danger">
                        <i class="fas fa-times me-2"></i>
                        انصراف
                    </a>
                </div>
            </div>
        </div>
    }
</div>

<style>
    .assignment-form-card {
        background: white;
        border-radius: 15px;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
    }
    .form-section {
        border: 1px solid #e9ecef;
        border-radius: 10px;
        padding: 20px;
        margin-bottom: 20px;
    }
    .form-section h5 {
        color: #667eea;
        border-bottom: 2px solid #667eea;
        padding-bottom: 10px;
        margin-bottom: 20px;
    }
    .select2-container--bootstrap4 .select2-selection--single {
        height: 38px;
        border: 1px solid #ced4da;
    }
    .help-text {
        font-size: 0.875rem;
        color: #6c757d;
        margin-top: 5px;
    }
</style>
