@model ClinicApp.Interfaces.PagedResult<ClinicApp.ViewModels.InsuranceViewModel>

@if (Model != null && Model.Items.Any())
{
    <div class="insurance-list-container">
        <div class="table-responsive">
            <table class="table table-medical">
                <thead>
                    <tr>
                        <th>نام بیمه</th>
                        <th>سهم بیمار</th>
                        <th>سهم بیمه</th>
                        <th>تعداد تعرفه‌ها</th>
                        <th class="text-center">وضعیت</th>
                        <th class="text-center">عملیات</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model.Items)
                    {
                        <tr data-id="@item.InsuranceId" data-name="@item.Name">
                            <td>
                                <div class="d-flex align-items-center">
                                    <i class="fas fa-shield-alt fa-lg text-primary me-2"></i>
                                    <span class="fw-bold">@item.Name</span>
                                </div>
                            </td>
                            <td class="fw-bold">@item.DefaultPatientShare%</td>
                            <td class="fw-bold">@item.DefaultInsurerShare%</td>
                            <td class="text-center">
                                <span class="badge bg-primary bg-opacity-10 text-primary rounded-pill px-3 py-1">
                                    @item.TariffCount
                                </span>
                            </td>
                            <td class="text-center">
                                <span class="status-badge @(item.IsActive ? "status-active" : "status-inactive")">
                                    @(item.IsActive ? "فعال" : "غیرفعال")
                                </span>
                            </td>
                            <td class="text-center">
                                <div class="action-buttons">
                                    <button type="button"
                                            class="btn-medical btn-details"
                                            data-id="@item.InsuranceId"
                                            data-name="@item.Name"
                                            title="جزئیات">
                                        <i class="fas fa-info-circle"></i>
                                    </button>
                                    <button type="button"
                                            class="btn-medical btn-edit"
                                            data-id="@item.InsuranceId"
                                            data-name="@item.Name"
                                            title="ویرایش">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button type="button"
                                            class="btn-medical btn-delete"
                                            data-id="@item.InsuranceId"
                                            data-name="@item.Name"
                                            title="حذف">
                                        <i class="fas fa-trash-alt"></i>
                                    </button>
                                    <button type="button"
                                            class="btn-medical btn-manage-tariffs"
                                            data-id="@item.InsuranceId"
                                            data-name="@item.Name"
                                            title="مدیریت تعرفه‌ها">
                                        <i class="fas fa-list"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>

        <div class="d-flex justify-content-between align-items-center p-3 border-top bg-light rounded-bottom">
            <div class="text-muted small">
                نمایش @((Model.PageNumber - 1) * Model.PageSize + 1) تا @(Math.Min(Model.PageNumber * Model.PageSize, Model.TotalItems)) از @Model.TotalItems مورد
            </div>
            <nav>
                <ul class="pagination pagination-medical mb-0">
                    @if (Model.HasPreviousPage)
                    {
                        <li class="page-item-medical">
                            <a class="page-link-medical" href="#" data-page="1" aria-label="اولین">&laquo;</a>
                        </li>
                        <li class="page-item-medical">
                            <a class="page-link-medical" href="#" data-page="@Model.PreviousPageNumber" aria-label="قبلی">&lsaquo;</a>
                        </li>
                    }
                    else
                    {
                        <li class="page-item-medical disabled"><span class="page-link-medical">&laquo;</span></li>
                        <li class="page-item-medical disabled"><span class="page-link-medical">&lsaquo;</span></li>
                    }

                    @for (int i = 1; i <= Model.TotalPages; i++)
                    {
                        <li class="page-item-medical @(i == Model.PageNumber ? "active" : "")">
                            <a class="page-link-medical" href="#" data-page="@i">@i</a>
                        </li>
                    }

                    @if (Model.HasNextPage)
                    {
                        <li class="page-item-medical">
                            <a class="page-link-medical" href="#" data-page="@Model.NextPageNumber" aria-label="بعدی">&rsaquo;</a>
                        </li>
                        <li class="page-item-medical">
                            <a class="page-link-medical" href="#" data-page="@Model.TotalPages" aria-label="آخرین">&raquo;</a>
                        </li>
                    }
                    else
                    {
                        <li class="page-item-medical disabled"><span class="page-link-medical">&rsaquo;</span></li>
                        <li class="page-item-medical disabled"><span class="page-link-medical">&raquo;</span></li>
                    }
                </ul>
            </nav>
        </div>
    </div>
}
else
{
    <div class="empty-state">
        <i class="fas fa-shield-alt fa-3x"></i>
        <h5>بیمه‌ای یافت نشد</h5>
        <p>هیچ بیمه‌ای با معیارهای جستجو یافت نشد. می‌توانید فیلترها را تغییر دهید یا بیمه جدیدی ایجاد کنید.</p>
        @if (!string.IsNullOrEmpty(ViewBag.SearchTerm))
        {
            <div class="mt-3">
                <button id="clear-search" class="btn btn-outline-primary">
                    <i class="fas fa-times-circle me-1"></i> پاک کردن جستجو
                </button>
            </div>
        }
    </div>
}