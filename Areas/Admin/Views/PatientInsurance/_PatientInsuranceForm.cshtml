@model ClinicApp.ViewModels.Insurance.PatientInsurance.PatientInsuranceCreateEditViewModel

<!-- 🏥 Medical Environment Validation Summary -->
@if (!ViewData.ModelState.IsValid)
{
    <div class="alert alert-danger medical-validation-alert" role="alert">
        <div class="d-flex align-items-center">
            <i class="fas fa-exclamation-triangle me-2"></i>
            <h5 class="mb-0">خطاهای اعتبارسنجی</h5>
        </div>
        <hr class="my-2">
        @Html.ValidationSummary(true, "", new { @class = "validation-summary-errors medical-validation-list" })
        <div class="mt-2">
            <small class="text-muted">
                <i class="fas fa-info-circle"></i>
                لطفاً خطاهای بالا را برطرف کرده و مجدداً تلاش کنید.
            </small>
        </div>
    </div>
}

<!-- 🏥 Patient Selection Section - Medical Environment Standards -->
<div class="form-section medical-form-section">
    <h4 class="section-title medical-section-title">
        <i class="fas fa-user-md"></i> انتخاب بیمار
        <span class="required-indicator">*</span>
    </h4>

    <div class="form-group medical-form-group">
        @Html.LabelFor(m => m.PatientId, new { @class = "form-label medical-form-label" })
        @Html.DropDownListFor(m => m.PatientId, new List<SelectListItem>(), "انتخاب بیمار", new { 
            @class = "form-control patient-select2 medical-form-control", 
            required = "required",
            data_medical_field = "patient-selection",
            aria_describedby = "patient-help"
        })
        @Html.ValidationMessageFor(m => m.PatientId, "", new { @class = "text-danger medical-validation-message" })
        
        <div class="patient-info medical-info-box" id="patient-help">
            <div class="info-text medical-info-text">
                <i class="fas fa-info-circle"></i>
                <strong>راهنمای انتخاب بیمار:</strong>
                <ul class="mt-2 mb-0">
                    <li>ابتدا بیمار مورد نظر را انتخاب کنید</li>
                    <li>سپس طرح بیمه مناسب را انتخاب نمایید</li>
                    <li>برای جستجو: نام، نام خانوادگی، کد ملی یا شماره تلفن</li>
                </ul>
            </div>
        </div>
    </div>
</div>

<!-- 🏥 Insurance Plan Selection Section - Medical Environment Standards -->
<div class="form-section medical-form-section">
    <h4 class="section-title medical-section-title">
        <i class="fas fa-shield-alt"></i> انتخاب طرح بیمه
        <span class="required-indicator">*</span>
    </h4>

    <div class="form-group medical-form-group">
        @Html.LabelFor(m => m.InsurancePlanId, new { @class = "form-label medical-form-label" })
        @Html.DropDownListFor(m => m.InsurancePlanId, Model.InsurancePlanSelectList, "انتخاب طرح بیمه", new { 
            @class = "form-control medical-form-control", 
            required = "required",
            data_medical_field = "insurance-plan",
            aria_describedby = "insurance-help"
        })
        @Html.ValidationMessageFor(m => m.InsurancePlanId, "", new { @class = "text-danger medical-validation-message" })
        
        <div class="insurance-info medical-info-box" id="insurance-help">
            <div class="info-text medical-info-text">
                <i class="fas fa-info-circle"></i>
                <strong>راهنمای انتخاب طرح بیمه:</strong>
                <ul class="mt-2 mb-0">
                    <li>طرح بیمه مورد نظر را انتخاب کنید</li>
                    <li>اطلاعات پوشش و فرانشیز به صورت خودکار نمایش داده خواهد شد</li>
                    <li>اطمینان حاصل کنید که طرح بیمه با نیازهای درمانی بیمار مطابقت دارد</li>
                </ul>
            </div>
        </div>
    </div>
</div>

<!-- 🏥 Policy Information Section - Medical Environment Standards -->
<div class="form-section medical-form-section">
    <h4 class="section-title medical-section-title">
        <i class="fas fa-file-contract"></i> اطلاعات بیمه‌نامه
    </h4>

    <div class="row">
        <div class="col-md-6">
            <div class="form-group medical-form-group">
                @Html.LabelFor(m => m.PolicyNumber, new { @class = "form-label medical-form-label" })
                @Html.TextBoxFor(m => m.PolicyNumber, new { 
                    @class = "form-control medical-form-control", 
                    placeholder = "شماره بیمه‌نامه (مثال: 1234567890)", 
                    required = "required",
                    data_medical_field = "policy-number",
                    pattern = "[0-9]{3,15}",
                    title = "شماره بیمه‌نامه باید 3 تا 15 رقم باشد",
                    aria_describedby = "policy-help"
                })
                @Html.ValidationMessageFor(m => m.PolicyNumber, "", new { @class = "text-danger medical-validation-message" })
                <div class="medical-info-box" id="policy-help">
                    <small class="text-muted">
                        <i class="fas fa-info-circle"></i>
                        شماره بیمه‌نامه باید 3 تا 15 رقم باشد
                    </small>
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="form-group medical-form-group">
                @Html.LabelFor(m => m.IsPrimary, new { @class = "form-label medical-form-label" })
                <div class="form-check medical-form-check">
                    @Html.CheckBoxFor(m => m.IsPrimary, new { 
                        @class = "form-check-input medical-form-check-input",
                        data_medical_field = "insurance-type"
                    })
                    @Html.LabelFor(m => m.IsPrimary, "بیمه اصلی", new { @class = "form-check-label medical-form-check-label" })
                </div>
                @Html.ValidationMessageFor(m => m.IsPrimary, "", new { @class = "text-danger medical-validation-message" })
                <div class="type-info medical-info-box">
                    <div class="info-text medical-info-text">
                        <i class="fas fa-info-circle"></i>
                        <strong>نوع بیمه:</strong>
                        <ul class="mt-2 mb-0">
                            <li><strong>بیمه اصلی:</strong> بیمه اولیه بیمار</li>
                            <li><strong>بیمه تکمیلی:</strong> بیمه ثانویه برای پوشش اضافی</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 🏥 Validity Period Section - Medical Environment Standards -->
<div class="form-section medical-form-section">
    <h4 class="section-title medical-section-title">
        <i class="fas fa-calendar-alt"></i> دوره اعتبار بیمه
        <span class="required-indicator">*</span>
    </h4>

    <div class="row">
        <div class="col-md-6">
            <div class="form-group medical-form-group">
                @Html.LabelFor(m => m.StartDateShamsi, new { @class = "form-label medical-form-label" })
                @Html.TextBoxFor(m => m.StartDateShamsi, new { 
                    @class = "form-control persian-datepicker medical-form-control", 
                    placeholder = "تاریخ شروع اعتبار (شمسی) - مثال: 1404/06/24", 
                    required = "required",
                    data_medical_field = "start-date",
                    pattern = "[0-9]{4}/[0-9]{2}/[0-9]{2}",
                    title = "فرمت تاریخ: 1404/06/24",
                    aria_describedby = "start-date-help"
                })
                @Html.ValidationMessageFor(m => m.StartDateShamsi, "", new { @class = "text-danger medical-validation-message" })
                @Html.HiddenFor(m => m.StartDate)
                <div class="medical-info-box" id="start-date-help">
                    <small class="text-muted">
                        <i class="fas fa-info-circle"></i>
                        تاریخ شروع اعتبار بیمه (فرمت: 1404/06/24)
                    </small>
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="form-group medical-form-group">
                @Html.LabelFor(m => m.EndDateShamsi, new { @class = "form-label medical-form-label" })
                @Html.TextBoxFor(m => m.EndDateShamsi, new { 
                    @class = "form-control persian-datepicker medical-form-control", 
                    placeholder = "تاریخ پایان اعتبار (شمسی) - مثال: 1405/06/24", 
                    required = "required",
                    data_medical_field = "end-date",
                    pattern = "[0-9]{4}/[0-9]{2}/[0-9]{2}",
                    title = "فرمت تاریخ: 1405/06/24",
                    aria_describedby = "end-date-help"
                })
                @Html.ValidationMessageFor(m => m.EndDateShamsi, "", new { @class = "text-danger medical-validation-message" })
                @Html.HiddenFor(m => m.EndDate)
                <div class="medical-info-box" id="end-date-help">
                    <small class="text-muted">
                        <i class="fas fa-info-circle"></i>
                        تاریخ پایان اعتبار بیمه (فرمت: 1405/06/24)
                    </small>
                </div>
            </div>
        </div>
    </div>

    <div class="validity-info medical-info-box">
        <div class="info-text medical-info-text">
            <i class="fas fa-info-circle"></i>
            <strong>دوره اعتبار بیمه بیمار:</strong>
            <ul class="mt-2 mb-0">
                <li>این بیمه فقط در بازه زمانی مشخص شده قابل استفاده است</li>
                <li>تاریخ پایان باید بعد از تاریخ شروع باشد</li>
                <li>اطمینان حاصل کنید که دوره اعتبار با نیازهای درمانی بیمار مطابقت دارد</li>
            </ul>
        </div>
    </div>
</div>

<!-- 🏥 Status Section - Medical Environment Standards -->
<div class="form-section medical-form-section">
    <h4 class="section-title medical-section-title">
        <i class="fas fa-toggle-on"></i> وضعیت بیمه
    </h4>

    <div class="form-group medical-form-group">
        <div class="form-check medical-form-check">
            @Html.CheckBoxFor(m => m.IsActive, new { 
                @class = "form-check-input medical-form-check-input",
                data_medical_field = "insurance-status"
            })
            @Html.LabelFor(m => m.IsActive, "بیمه فعال", new { @class = "form-check-label medical-form-check-label" })
        </div>
        @Html.ValidationMessageFor(m => m.IsActive, "", new { @class = "text-danger medical-validation-message" })
        
        <div class="medical-info-box">
            <div class="info-text medical-info-text">
                <i class="fas fa-info-circle"></i>
                <strong>وضعیت بیمه:</strong>
                <ul class="mt-2 mb-0">
                    <li><strong>فعال:</strong> بیمه قابل استفاده برای خدمات درمانی</li>
                    <li><strong>غیرفعال:</strong> بیمه موقتاً غیرقابل استفاده</li>
                </ul>
            </div>
        </div>
    </div>
</div>